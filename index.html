<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë„¤ì´ë²„ì›ìŠ¤ ìë™ ì•Œë¦¼ ìŠ¤ì¼€ì¤„ëŸ¬</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            background-color: #f4f6f9;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            color: #333;
        }
        .container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 1000px;
            box-sizing: border-box;
            border: 1px solid #e0e0e0;
        }
        h1, h2 {
            color: #2c3e50;
            margin-bottom: 25px;
            text-align: center;
            font-weight: 600;
        }
        
        /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ ìŠ¤íƒ€ì¼ */
        .tab-nav {
            display: flex;
            border-bottom: 2px solid #e0e0e0;
            margin-bottom: 30px;
        }
        .tab-nav button {
            background-color: transparent;
            border: none;
            padding: 15px 20px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            color: #666;
            font-weight: 500;
        }
        .tab-nav button:hover {
            background-color: #f8f9fa;
            color: #333;
        }
        .tab-nav button.active {
            color: #007bff;
            border-bottom-color: #007bff;
            background-color: #f8f9fa;
        }
        
        /* íƒ­ ì»¨í…ì¸  ìŠ¤íƒ€ì¼ */
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fcfcfc;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        input[type="text"],
        input[type="password"],
        input[type="date"],
        input[type="checkbox"],
        textarea,
        select {
            width: calc(100% - 22px);
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 0.95em;
            box-sizing: border-box;
        }
        input[type="checkbox"] {
            width: auto;
            margin-right: 5px;
        }
        textarea {
            height: 80px;
            resize: vertical;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.2);
            margin-top: 10px;
        }
        button:hover {
            background-color: #0056b3;
            transform: translateY(-1px);
        }
        button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
            opacity: 0.6;
            transform: none;
        }
        button.delete-btn {
            background-color: #dc3545;
            box-shadow: 0 2px 8px rgba(220, 53, 69, 0.2);
            margin-left: 10px;
        }
        button.delete-btn:hover {
            background-color: #c82333;
        }
        button.edit-btn {
            background-color: #ffc107;
            color: #333;
            box-shadow: 0 2px 8px rgba(255, 193, 7, 0.2);
        }
        button.edit-btn:hover {
            background-color: #e0a800;
        }
        button.execute-btn {
            background-color: #28a745;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.2);
            margin-left: 10px;
        }
        button.execute-btn:hover {
            background-color: #218838;
        }
        button.secondary-btn {
            background-color: #6c757d;
            box-shadow: 0 2px 8px rgba(108, 117, 125, 0.2);
        }
        button.secondary-btn:hover {
            background-color: #545b62;
        }
        button.cancel-btn {
            background-color: #dc3545;
            box-shadow: 0 2px 8px rgba(220, 53, 69, 0.2);
        }
        button.cancel-btn:hover {
            background-color: #c82333;
        }
        .status-message {
            margin-top: 20px;
            padding: 10px;
            border-radius: 6px;
            font-size: 0.95em;
            background-color: #e9ecef;
            color: #333;
            border: 1px solid #dee2e6;
        }
        .status-message.success {
            background-color: #d4edda;
            color: #155724;
            border-color: #c3e6cb;
        }
        .status-message.error {
            background-color: #f8d7da;
            color: #721c24;
            border-color: #f5c6cb;
        }
        .status-message.info {
            background-color: #d1ecf1;
            color: #0c5460;
            border-color: #bee5eb;
        }
        .schedule-item, .team-member-item, .duty-item, .review-pair-item {
            display: flex;
            flex-direction: column;
            padding: 15px;
            margin-bottom: 10px;
            border: 1px solid #e9ecef;
            border-left: 5px solid #007bff;
            border-radius: 8px;
            background-color: #ffffff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .schedule-item.type-laptop_duty { border-left-color: #28a745; }
        .schedule-item.type-code_review { border-left-color: #6f42c1; }
        .schedule-item p, .team-member-item p, .duty-item p, .review-pair-item p {
            margin: 5px 0;
            font-size: 0.9em;
        }
        .schedule-item strong, .team-member-item strong, .duty-item strong, .review-pair-item strong {
            color: #0056b3;
        }
        .schedule-item .actions, .team-member-item .actions, .duty-item .actions, .review-pair-item .actions {
            margin-top: 10px;
            text-align: right;
        }
        .schedule-item .actions button, .team-member-item .actions button, .duty-item .actions button {
            padding: 6px 12px;
            font-size: 0.85em;
            margin-left: 5px;
        }
        .cron-guide {
            font-size: 0.8em;
            color: #777;
            margin-top: 5px;
            line-height: 1.4;
        }
        .cron-guide a {
            color: #007bff;
            text-decoration: none;
        }
        .cron-guide a:hover {
            text-decoration: underline;
        }
        .flex-group {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }
        .flex-group label {
            margin-bottom: 0;
            margin-right: 10px;
        }
        .current-status {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        .current-status h3 {
            margin: 0 0 10px 0;
            color: white;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .stat-card h4 {
            margin: 0 0 5px 0;
            color: #007bff;
            font-size: 0.9em;
        }
        .stat-card p {
            margin: 0;
            font-size: 1.2em;
            font-weight: 600;
        }
        .quick-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .quick-actions button {
            margin-top: 0;
        }
        
        /* ì£¼ê°„ ë‹¹ì§ í¸ì„±í‘œ ìŠ¤íƒ€ì¼ */
        .weekly-schedule-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .duty-day {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: box-shadow 0.2s ease;
        }
        .duty-day:hover {
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .duty-day.today {
            border-color: #007bff;
            background: linear-gradient(135deg, #f8f9ff 0%, #e3f2fd 100%);
        }
        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-weight: 600;
            color: #333;
        }
        .today-badge {
            background: #007bff;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 500;
        }
        .duty-members {
            color: #666;
            font-size: 0.9em;
        }
        .duty-day.today .duty-members {
            color: #0056b3;
            font-weight: 500;
        }
        
        /* ì˜¤ëŠ˜ì˜ ë‹¹ì§ì ìŠ¤íƒ€ì¼ */
        .today-duty-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .today-duty-card.no-duty {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            color: #333;
        }
        .duty-info h3 {
            margin: 0 0 15px 0;
            font-size: 1.3em;
            color: white;
        }
        .today-duty-card.no-duty .duty-info h3 {
            color: #333;
        }
        .duty-members-large {
            font-size: 1.4em;
            font-weight: 600;
            margin: 10px 0;
        }
        .duty-date {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        .duty-tasks {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        .duty-tasks h4 {
            margin: 0 0 10px 0;
            font-size: 1.1em;
        }
        .duty-tasks ul {
            margin: 0;
            padding-left: 20px;
        }
        .duty-tasks li {
            margin-bottom: 5px;
            font-size: 0.9em;
        }
        
        /* ë¡œë”© ìƒíƒœ ìŠ¤íƒ€ì¼ */
        button.execute-btn:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
            opacity: 0.6;
        }
        button.execute-btn.loading {
            background-color: #6c757d;
            cursor: wait;
            position: relative;
            padding-right: 50px;
        }
        button.execute-btn.loading::after {
            content: "";
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            border: 2px solid #ffffff;
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: translateY(-50%) rotate(0deg); }
            100% { transform: translateY(-50%) rotate(360deg); }
        }
        
        /* ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸° ê´€ë ¨ ìŠ¤íƒ€ì¼ ê°œì„  */
        .report-preview-section {
            position: relative;
        }
        .report-preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .report-preview-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .report-status {
            font-size: 0.85em;
            color: #6c757d;
            font-weight: normal;
            padding: 4px 8px;
            border-radius: 4px;
            background: #f8f9fa;
        }
        .report-status.generating {
            color: #007bff;
            background: #e3f2fd;
            font-weight: 500;
            animation: pulse 2s ease-in-out infinite;
        }
        .report-status.completed {
            color: #28a745;
            background: #e8f5e8;
            font-weight: 500;
        }
        .report-status.error {
            color: #dc3545;
            background: #f8d7da;
            font-weight: 500;
        }
        .report-status.cancelled {
            color: #6c757d;
            background: #f8f9fa;
            font-weight: 500;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        .report-preview-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .report-preview-actions button {
            margin: 0;
            padding: 6px 12px;
            font-size: 0.9em;
        }
        .report-preview-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 120px;
            color: #6c757d;
            font-style: italic;
            flex-direction: column;
            gap: 10px;
        }
        .report-preview-loading::before {
            content: "";
            width: 24px;
            height: 24px;
            border: 3px solid #6c757d;
            border-top: 3px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        .report-preview-content {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.4;
            white-space: pre-wrap;
            min-height: 120px;
            border: 1px solid #ddd;
            position: relative;
        }
        .report-preview-placeholder {
            color: #6c757d;
            font-style: italic;
            text-align: center;
            padding: 40px 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .report-send-actions {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        .report-send-actions h4 {
            margin: 0 0 10px 0;
            color: #333;
            font-size: 1em;
        }
        .report-send-actions .actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        /* ë¦¬í¬íŠ¸ ê´€ë¦¬ ê´€ë ¨ ìŠ¤íƒ€ì¼ */
        .report-management {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        .report-management h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 1.1em;
        }
        .storage-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .storage-stat {
            background: white;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #28a745;
            text-align: center;
        }
        .storage-stat h4 {
            margin: 0 0 5px 0;
            color: #28a745;
            font-size: 0.9em;
        }
        .storage-stat p {
            margin: 0;
            font-size: 1.1em;
            font-weight: 600;
        }
        .report-history {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
        }
        .report-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            border-bottom: 1px solid #eee;
        }
        .report-item:last-child {
            border-bottom: none;
        }
        .report-item:hover {
            background: #f8f9fa;
        }
        .report-info {
            flex-grow: 1;
        }
        .report-info .report-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 3px;
        }
        .report-info .report-meta {
            font-size: 0.85em;
            color: #666;
        }
        .report-actions {
            display: flex;
            gap: 5px;
        }
        .report-actions button {
            padding: 4px 8px;
            font-size: 0.8em;
            margin: 0;
        }
        .progress-details {
            margin-top: 10px;
            padding: 10px;
            background: #e3f2fd;
            border-radius: 6px;
            font-size: 0.9em;
            color: #0c5460;
            display: none;
        }
        .progress-details.visible {
            display: block;
        }
        .progress-step {
            margin-bottom: 5px;
        }
        .progress-step:last-child {
            margin-bottom: 0;
        }
        .progress-step .step-name {
            font-weight: 600;
        }
        .progress-step .step-detail {
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ë„¤ì´ë²„ì›ìŠ¤ ìë™ ì•Œë¦¼ ìŠ¤ì¼€ì¤„ëŸ¬</h1>
        
        <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="tab-nav">
            <button class="tab-btn active" data-tab="status">ì½”ë“œë¦¬ë·° ì§ê¿ & ë‹¹ì§ í˜„í™©</button>
            <button class="tab-btn" data-tab="team">íŒ€ì› ë° ë‹¹ì§ ê´€ë¦¬</button>
            <button class="tab-btn" data-tab="schedule">í¬ë¡ ë©”ì‹œì§€ ê´€ë¦¬</button>
            <button class="tab-btn" data-tab="github">ğŸ”¥ GitHub ì„±ê³¼ ë¶„ì„</button>
        </div>

        <!-- íƒ­ 1: ì½”ë“œë¦¬ë·° ì§ê¿ & ë‹¹ì§ í˜„í™© -->
        <div id="status-tab" class="tab-content active">
            <div class="current-status">
                <h3>ğŸš€ ìë™ ìŠ¤ì¼€ì¤„ ì‹œìŠ¤í…œ ê°€ë™ ì¤‘</h3>
                <p>ì£¼ê°„ ë‹¹ì§: ë§¤ì£¼ ì›”ìš”ì¼ 8ì‹œ | ë‹¹ì§ ì•Œë¦¼: ë§¤ì¼ 2ì‹œ, 4ì‹œ | ì½”ë“œë¦¬ë·°: ë§¤ì£¼ ì›”ìš”ì¼ 9ì‹œ</p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <h4>ë“±ë¡ëœ íŒ€ì›</h4>
                    <p id="totalMembers">0ëª…</p>
                </div>
                <div class="stat-card">
                    <h4>ê¶Œí•œì</h4>
                    <p id="authorizedMembers">0ëª…</p>
                </div>
                <div class="stat-card">
                    <h4>í™œì„± ìŠ¤ì¼€ì¤„</h4>
                    <p id="activeSchedules">0ê°œ</p>
                </div>
                <div class="stat-card">
                    <h4>ì´ë²ˆ ì£¼</h4>
                    <p id="currentWeek">-</p>
                </div>
            </div>

            <div class="quick-actions">
                <button id="executeWeeklyDuty" class="execute-btn">ì£¼ê°„ ë‹¹ì§ í¸ì„± ì‹¤í–‰</button>
                <button id="executeCodeReview" class="execute-btn">ì½”ë“œë¦¬ë·° ì§ê¿ í¸ì„± ì‹¤í–‰</button>
                <button id="refreshStatus" class="secondary-btn">í˜„í™© ìƒˆë¡œê³ ì¹¨</button>
            </div>

            <div class="section">
                <h2>ğŸ“… ì´ë²ˆì£¼ ë‹¹ì§ í¸ì„±í‘œ</h2>
                <div id="weeklyDutySchedule">
                    <p>ë¡œë”© ì¤‘...</p>
                </div>
            </div>
            
            <div class="section">
                <h2>ğŸš¨ ì˜¤ëŠ˜ì˜ ë‹¹ì§ì</h2>
                <div id="todayDutyStatus">
                    <p>ë¡œë”© ì¤‘...</p>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ‘¥ í˜„ì¬ ì½”ë“œë¦¬ë·° ì§ê¿</h2>
                <div id="currentCodeReviewPairs">
                    <p>ë¡œë”© ì¤‘...</p>
                </div>
            </div>

            <div id="statusMessage" class="status-message" style="display: none;"></div>
        </div>

        <!-- íƒ­ 2: íŒ€ì› ë° ë‹¹ì§ ê´€ë¦¬ -->
        <div id="team-tab" class="tab-content">
            <div class="section">
                <h2>íŒ€ì› ê´€ë¦¬</h2>
                <div class="form-group">
                    <label for="teamMemberIdInput">íŒ€ì› ID:</label>
                    <input type="text" id="teamMemberIdInput" placeholder="ì˜ˆ: tmddud333">
                </div>
                <div class="form-group">
                    <label for="teamMemberNameInput">íŒ€ì› ì´ë¦„:</label>
                    <input type="text" id="teamMemberNameInput" placeholder="ì˜ˆ: í™ê¸¸ë™">
                </div>
                <div class="flex-group">
                    <input type="checkbox" id="isAuthorizedCheckbox">
                    <label for="isAuthorizedCheckbox">ê¶Œí•œ ìˆëŠ” íŒ€ì› (ë‹¹ì§ í•„ìˆ˜ í¬í•¨)</label>
                </div>
                <button id="addTeamMemberButton">íŒ€ì› ì¶”ê°€</button>
                <div id="teamMemberStatusMessage" class="status-message" style="display: none;"></div>
                
                <h3>ë“±ë¡ëœ íŒ€ì›</h3>
                <div id="teamMemberList">
                    <p>ë¡œë”© ì¤‘...</p>
                </div>
            </div>
        </div>

        <!-- íƒ­ 3: í¬ë¡ ë©”ì‹œì§€ ê´€ë¦¬ -->
        <div id="schedule-tab" class="tab-content">
            <div class="section">
                <h2>ìƒˆ ìŠ¤ì¼€ì¤„ ì¶”ê°€ / í¸ì§‘</h2>
                <div class="form-group">
                    <label for="scheduleTypeSelect">ìŠ¤ì¼€ì¤„ íƒ€ì…:</label>
                    <select id="scheduleTypeSelect">
                        <option value="message">ì¼ë°˜ ë©”ì‹œì§€ ì•Œë¦¼</option>
                        <option value="laptop_duty">ë…¸íŠ¸ë¶ ì§€ì°¸ ì•Œë¦¼</option>
                        <option value="code_review">ì½”ë“œ ë¦¬ë·° ì§ê¿ ì•Œë¦¼</option>
                    </select>
                </div>
                <div class="form-group" id="messageGroup">
                    <label for="messageInput">ë©”ì‹œì§€ ë‚´ìš©:</label>
                    <textarea id="messageInput" placeholder="ì—¬ê¸°ì— ë³´ë‚¼ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                </div>
                <div class="form-group">
                    <label for="cronScheduleInput">ìŠ¤ì¼€ì¤„ (Cron í˜•ì‹):</label>
                    <input type="text" id="cronScheduleInput" placeholder="ì˜ˆ: 0 0 9 * * MON (ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤ì „ 9ì‹œ)">
                    <div class="cron-guide">
                        <a href="https://crontab.guru/" target="_blank">Cron í˜•ì‹ ê°€ì´ë“œ ë³´ê¸° (crontab.guru)</a><br>
                        ì´ˆ(0-59) ë¶„(0-59) ì‹œ(0-23) ì¼(1-31) ì›”(1-12) ìš”ì¼(0-7, ì¼ìš”ì¼=0 or 7)
                    </div>
                </div>
                <div class="form-group" id="recipientsGroup">
                    <label for="recipientsInput">ìˆ˜ì‹ ì ID (ì½¤ë§ˆë¡œ êµ¬ë¶„):</label>
                    <input type="text" id="recipientsInput" placeholder="ì˜ˆ: tmddud333, user2, user_test (ì¼ë°˜ ë©”ì‹œì§€ íƒ€ì…ë§Œ í•´ë‹¹)">
                </div>
                <button id="saveScheduleButton">ìŠ¤ì¼€ì¤„ ì €ì¥</button>
                <div id="scheduleStatusMessage" class="status-message" style="display: none;"></div>
            </div>

            <div class="section">
                <h2>ë“±ë¡ëœ ìŠ¤ì¼€ì¤„</h2>
                <div id="scheduledList">
                    <p>ë¡œë”© ì¤‘...</p>
                </div>
            </div>
        </div>

        <!-- íƒ­ 4: GitHub ì„±ê³¼ ë¶„ì„ -->
        <div id="github-tab" class="tab-content">
            <div class="section">
                <h2>ğŸ”¥ GitHub ì„œë¹„ìŠ¤ ìƒíƒœ</h2>
                <div id="githubStatusInfo" class="stats-grid">
                    <div class="stat-card">
                        <h4>GitHub ì„œë¹„ìŠ¤</h4>
                        <p id="githubServiceStatus">í™•ì¸ ì¤‘...</p>
                    </div>
                    <div class="stat-card">
                        <h4>ëª¨ë‹ˆí„°ë§ ë ˆí¬</h4>
                        <p id="githubRepoCount">0ê°œ</p>
                    </div>
                    <div class="stat-card">
                        <h4>ë¶„ì„ ëŒ€ìƒ ë©¤ë²„</h4>
                        <p id="githubMemberCount">0ëª…</p>
                    </div>
                    <div class="stat-card">
                        <h4>ì£¼ê°„ ë¦¬í¬íŠ¸</h4>
                        <p id="githubWeeklyStatus">ë¹„í™œì„±</p>
                    </div>
                </div>
                
                <div class="quick-actions">
                    <button id="githubRefreshStatus" class="secondary-btn">GitHub ìƒíƒœ ìƒˆë¡œê³ ì¹¨</button>
                    <button id="githubPreviewWeekly" class="execute-btn">GitHub ì£¼ê°„ ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸°</button>
                    <button id="githubPreviewMonthly" class="execute-btn">GitHub ì›”ê°„ ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸°</button>
                    <button id="githubCheckAlerts" class="execute-btn">GitHub í™œë™ ì•Œë¦¼ ì²´í¬</button>
                </div>
            </div>

            <div class="section">
                <h2>ì»¤ìŠ¤í…€ ë¦¬í¬íŠ¸ ìƒì„±</h2>
                <div class="form-group">
                    <label for="githubStartDate">ì‹œì‘ì¼:</label>
                    <input type="date" id="githubStartDate">
                </div>
                <div class="form-group">
                    <label for="githubEndDate">ì¢…ë£Œì¼:</label>
                    <input type="date" id="githubEndDate">
                </div>
                <div class="flex-group">
                    <input type="checkbox" id="githubSendToChannel" checked>
                    <label for="githubSendToChannel">ì±„ë„ë¡œ ë¦¬í¬íŠ¸ ì „ì†¡</label>
                </div>
                <button id="githubGenerateCustomReport" class="execute-btn">ì»¤ìŠ¤í…€ ë¦¬í¬íŠ¸ ìƒì„±</button>
                <div id="githubCustomReportMessage" class="status-message" style="display: none;"></div>
            </div>

            <div class="section">
                <h2>ê°œë³„ ë©¤ë²„ í†µê³„</h2>
                <div class="form-group">
                    <label for="githubMemberSelect">ë©¤ë²„ ì„ íƒ:</label>
                    <select id="githubMemberSelect">
                        <option value="">ë©¤ë²„ ì„ íƒ...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="githubMemberStartDate">ë¶„ì„ ê¸°ê°„ ì‹œì‘ì¼:</label>
                    <input type="date" id="githubMemberStartDate">
                </div>
                <div class="form-group">
                    <label for="githubMemberEndDate">ë¶„ì„ ê¸°ê°„ ì¢…ë£Œì¼:</label>
                    <input type="date" id="githubMemberEndDate">
                </div>
                <button id="githubGetMemberStats" class="execute-btn">ë©¤ë²„ í†µê³„ ì¡°íšŒ</button>
                <div id="githubMemberStatsResult" class="status-message" style="display: none;"></div>
            </div>

            <div class="section">
                <h2>GitHub ì„¤ì • ê´€ë¦¬</h2>
                <div class="form-group">
                    <label for="githubToken">GitHub í† í°:</label>
                    <input type="password" id="githubToken" placeholder="GitHub Personal Access Token">
                </div>
                <div class="form-group">
                    <label for="githubRepoList">ëª¨ë‹ˆí„°ë§ ë ˆí¬ì§€í† ë¦¬ (owner/repo í˜•ì‹, ì—”í„°ë¡œ êµ¬ë¶„):</label>
                    <textarea id="githubRepoList" placeholder="ì˜ˆ:&#10;your-org/project1&#10;your-org/project2"></textarea>
                </div>
                <div class="form-group">
                    <label for="githubTeamMembers">GitHub íŒ€ì› ì„¤ì • (username:displayName, ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„):</label>
                    <textarea id="githubTeamMembers" placeholder="ì˜ˆ:&#10;tmddud333:ìŠ¹ë¯¼&#10;cmjeong:ì°½ë¯¼"></textarea>
                </div>
                <div class="flex-group">
                    <input type="checkbox" id="githubWeeklyEnabled" checked>
                    <label for="githubWeeklyEnabled">ì£¼ê°„ ë¦¬í¬íŠ¸ ìë™ ë°œì†¡</label>
                </div>
                <div class="flex-group">
                    <input type="checkbox" id="githubMonthlyEnabled" checked>
                    <label for="githubMonthlyEnabled">ì›”ê°„ ë¦¬í¬íŠ¸ ìë™ ë°œì†¡</label>
                </div>
                <button id="githubUpdateConfig" class="execute-btn">GitHub ì„¤ì • ì €ì¥</button>
                <div id="githubConfigMessage" class="status-message" style="display: none;"></div>
            </div>

            <div class="section report-preview-section">
                <div class="report-preview-header">
                    <div class="report-preview-title">
                        <h2>ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸°</h2>
                        <span id="githubReportStatus" class="report-status">ëŒ€ê¸° ì¤‘</span>
                    </div>
                    <div class="report-preview-actions">
                        <button id="githubCancelReport" class="cancel-btn" style="display: none;">ì·¨ì†Œ</button>
                    </div>
                </div>
                
                <div id="githubReportPreview" class="report-preview-content">
                    <div class="report-preview-placeholder">
                        ğŸ“Š ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸°ë¥¼ ë³´ë ¤ë©´ ìœ„ì˜ 'ë¯¸ë¦¬ë³´ê¸°' ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.
                    </div>
                </div>
                
                <!-- ì§„í–‰ë„ ì„¸ë¶€ì‚¬í•­ -->
                <div id="githubProgressDetails" class="progress-details">
                    <div id="progressSteps"></div>
                </div>
                
                <div id="githubSendButtons" class="report-send-actions" style="display: none;">
                    <h4>ğŸ“¤ ë¦¬í¬íŠ¸ ì „ì†¡</h4>
                    <p>ìƒì„±ëœ ë¦¬í¬íŠ¸ë¥¼ ë„¤ì´ë²„ì›ìŠ¤ ì±„ë„ë¡œ ì „ì†¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
                    <div class="actions">
                        <button id="githubSendReport" class="execute-btn">ë¦¬í¬íŠ¸ ë°œì†¡</button>
                        <button id="githubDiscardReport" class="secondary-btn">ì·¨ì†Œ</button>
                    </div>
                </div>
            </div>

            <div class="section report-management">
                <h3>ğŸ“ ë¦¬í¬íŠ¸ ê´€ë¦¬</h3>
                
                <!-- ì €ì¥ì†Œ í†µê³„ -->
                <h4>ì €ì¥ì†Œ í˜„í™©</h4>
                <div id="githubStorageStats" class="storage-stats">
                    <div class="storage-stat">
                        <h4>ë¯¸ë¦¬ë³´ê¸°</h4>
                        <p id="previewCount">0ê°œ</p>
                    </div>
                    <div class="storage-stat">
                        <h4>ì•„ì¹´ì´ë¸Œ</h4>
                        <p id="archiveCount">0ê°œ</p>
                    </div>
                    <div class="storage-stat">
                        <h4>ì´ ìš©ëŸ‰</h4>
                        <p id="totalSize">0.00 MB</p>
                    </div>
                </div>
                
                <!-- ê´€ë¦¬ ì•¡ì…˜ -->
                <div class="quick-actions">
                    <button id="githubRefreshStorage" class="secondary-btn">ì €ì¥ì†Œ ìƒˆë¡œê³ ì¹¨</button>
                    <button id="githubClearCacheBtn" class="secondary-btn">ìºì‹œ ì •ë¦¬</button>
                    <button id="githubToggleHistory" class="secondary-btn">ë¦¬í¬íŠ¸ ì´ë ¥ ë³´ê¸°</button>
                </div>
                
                <!-- ë¦¬í¬íŠ¸ ì´ë ¥ -->
                <div id="githubReportHistorySection" style="display: none;">
                    <h4>ìµœê·¼ ë¦¬í¬íŠ¸ ì´ë ¥</h4>
                    <div id="githubReportHistory" class="report-history">
                        <p style="text-align: center; padding: 20px; color: #666;">ë¡œë”© ì¤‘...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM ìš”ì†Œë“¤
        const tabButtons = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');
        
        // ìƒíƒœ íƒ­ ìš”ì†Œë“¤
        const totalMembersSpan = document.getElementById('totalMembers');
        const authorizedMembersSpan = document.getElementById('authorizedMembers');
        const activeSchedulesSpan = document.getElementById('activeSchedules');
        const currentWeekSpan = document.getElementById('currentWeek');
        const weeklyDutyScheduleDiv = document.getElementById('weeklyDutySchedule');
        const todayDutyStatusDiv = document.getElementById('todayDutyStatus');
        const currentCodeReviewPairsDiv = document.getElementById('currentCodeReviewPairs');
        const statusMessageDiv = document.getElementById('statusMessage');
        const executeWeeklyDutyBtn = document.getElementById('executeWeeklyDuty');
        const executeCodeReviewBtn = document.getElementById('executeCodeReview');
        const refreshStatusBtn = document.getElementById('refreshStatus');

        // íŒ€ì› ê´€ë¦¬ íƒ­ ìš”ì†Œë“¤
        const teamMemberIdInput = document.getElementById('teamMemberIdInput');
        const teamMemberNameInput = document.getElementById('teamMemberNameInput');
        const isAuthorizedCheckbox = document.getElementById('isAuthorizedCheckbox');
        const addTeamMemberButton = document.getElementById('addTeamMemberButton');
        const teamMemberStatusMessageDiv = document.getElementById('teamMemberStatusMessage');
        const teamMemberListDiv = document.getElementById('teamMemberList');

        // ìŠ¤ì¼€ì¤„ ê´€ë¦¬ íƒ­ ìš”ì†Œë“¤
        const scheduleTypeSelect = document.getElementById('scheduleTypeSelect');
        const messageGroup = document.getElementById('messageGroup');
        const messageInput = document.getElementById('messageInput');
        const cronScheduleInput = document.getElementById('cronScheduleInput');
        const recipientsGroup = document.getElementById('recipientsGroup');
        const recipientsInput = document.getElementById('recipientsInput');
        const saveScheduleButton = document.getElementById('saveScheduleButton');
        const scheduleStatusMessageDiv = document.getElementById('scheduleStatusMessage');
        const scheduledListDiv = document.getElementById('scheduledList');
        
        // GitHub íƒ­ ìš”ì†Œë“¤
        const githubServiceStatusSpan = document.getElementById('githubServiceStatus');
        const githubRepoCountSpan = document.getElementById('githubRepoCount');
        const githubMemberCountSpan = document.getElementById('githubMemberCount');
        const githubWeeklyStatusSpan = document.getElementById('githubWeeklyStatus');
        const githubRefreshStatusBtn = document.getElementById('githubRefreshStatus');
        const githubPreviewWeeklyBtn = document.getElementById('githubPreviewWeekly');
        const githubPreviewMonthlyBtn = document.getElementById('githubPreviewMonthly');
        const githubSendReportBtn = document.getElementById('githubSendReport');
        const githubDiscardReportBtn = document.getElementById('githubDiscardReport');
        const githubCancelReportBtn = document.getElementById('githubCancelReport');
        const githubSendButtonsDiv = document.getElementById('githubSendButtons');
        const githubCheckAlertsBtn = document.getElementById('githubCheckAlerts');
        const githubStartDateInput = document.getElementById('githubStartDate');
        const githubEndDateInput = document.getElementById('githubEndDate');
        const githubSendToChannelCheckbox = document.getElementById('githubSendToChannel');
        const githubGenerateCustomReportBtn = document.getElementById('githubGenerateCustomReport');
        const githubCustomReportMessageDiv = document.getElementById('githubCustomReportMessage');
        const githubMemberSelect = document.getElementById('githubMemberSelect');
        const githubMemberStartDateInput = document.getElementById('githubMemberStartDate');
        const githubMemberEndDateInput = document.getElementById('githubMemberEndDate');
        const githubGetMemberStatsBtn = document.getElementById('githubGetMemberStats');
        const githubMemberStatsResultDiv = document.getElementById('githubMemberStatsResult');
        const githubTokenInput = document.getElementById('githubToken');
        const githubRepoListTextarea = document.getElementById('githubRepoList');
        const githubTeamMembersTextarea = document.getElementById('githubTeamMembers');
        const githubWeeklyEnabledCheckbox = document.getElementById('githubWeeklyEnabled');
        const githubMonthlyEnabledCheckbox = document.getElementById('githubMonthlyEnabled');
        const githubUpdateConfigBtn = document.getElementById('githubUpdateConfig');
        const githubConfigMessageDiv = document.getElementById('githubConfigMessage');
        const githubReportPreviewDiv = document.getElementById('githubReportPreview');
        const githubReportStatusSpan = document.getElementById('githubReportStatus');
        const githubProgressDetailsDiv = document.getElementById('githubProgressDetails');
        const progressStepsDiv = document.getElementById('progressSteps');
        
        // ë¦¬í¬íŠ¸ ê´€ë¦¬ ìš”ì†Œë“¤
        const githubStorageStatsDiv = document.getElementById('githubStorageStats');
        const previewCountSpan = document.getElementById('previewCount');
        const archiveCountSpan = document.getElementById('archiveCount');
        const totalSizeSpan = document.getElementById('totalSize');
        const githubRefreshStorageBtn = document.getElementById('githubRefreshStorage');
        const githubClearCacheBtnBtn = document.getElementById('githubClearCacheBtn');
        const githubToggleHistoryBtn = document.getElementById('githubToggleHistory');
        const githubReportHistorySection = document.getElementById('githubReportHistorySection');
        const githubReportHistoryDiv = document.getElementById('githubReportHistory');

        let currentConfig = { 
            schedules: [], 
            teamMembers: [], 
            currentLaptopDutyPair: [],
            dailyDutySchedule: {},
            codeReviewPairs: []
        };
        let editingTeamMemberId = null;
        
        // GitHub ê´€ë ¨ ë³€ìˆ˜ë“¤
        let currentReportData = null;
        let currentReportType = null;
        let isGeneratingReport = false;
        let reportGenerationAborted = false;
        let progressIntervalId = null;
        let currentProgressData = null;

        // íƒ­ ë„¤ë¹„ê²Œì´ì…˜ ì´ë²¤íŠ¸
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const targetTab = button.dataset.tab;
                
                // íƒ­ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ë³€ê²½
                tabButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                // íƒ­ ì»¨í…ì¸  í‘œì‹œ/ìˆ¨ê¹€
                tabContents.forEach(content => content.classList.remove('active'));
                document.getElementById(`${targetTab}-tab`).classList.add('active');
                
                // ìƒíƒœ íƒ­ì´ í™œì„±í™”ë˜ë©´ í˜„í™© ì—…ë°ì´íŠ¸
                if (targetTab === 'status') {
                    updateStatusTab();
                }
                
                // GitHub íƒ­ì´ í™œì„±í™”ë˜ë©´ GitHub ìƒíƒœ ë¡œë“œ
                if (targetTab === 'github') {
                    loadGitHubStatus();
                }
            });
        });

        function showStatus(messageDiv, message, type = 'info') {
            messageDiv.textContent = message;
            messageDiv.className = `status-message ${type}`;
            messageDiv.style.display = 'block';
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 5000);
        }

        function getWeekKey(date = new Date()) {
            const kstDate = new Date(date.toLocaleString("en-US", {timeZone: "Asia/Seoul"}));
            const year = kstDate.getFullYear();
            const week = getWeekNumber(kstDate);
            return `${year}-W${week.toString().padStart(2, '0')}`;
        }

        function getWeekNumber(date) {
            const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
            const pastDaysOfYear = (date - firstDayOfYear) / 86400000;
            return Math.ceil((pastDaysOfYear + firstDayOfYear.getDay() + 1) / 7);
        }

        // ìƒíƒœ íƒ­ ì—…ë°ì´íŠ¸
        async function updateStatusTab() {
            const totalMembers = currentConfig.teamMembers.length;
            const authorizedCount = currentConfig.teamMembers.filter(m => m.isAuthorized).length;
            const activeScheduleCount = currentConfig.schedules.length + 4; // ê¸°ë³¸ ìŠ¤ì¼€ì¤„ 4ê°œ í¬í•¨
            const weekKey = getWeekKey();

            totalMembersSpan.textContent = `${totalMembers}ëª…`;
            authorizedMembersSpan.textContent = `${authorizedCount}ëª…`;
            activeSchedulesSpan.textContent = `${activeScheduleCount}ê°œ`;
            currentWeekSpan.textContent = weekKey;

            // ì´ë²ˆì£¼ ë‹¹ì§ í¸ì„±í‘œ ë¡œë“œ
            await loadWeeklyDutySchedule();
            
            // ì˜¤ëŠ˜ì˜ ë‹¹ì§ì ë¡œë“œ
            await loadTodayDutyStatus();
            
            // í˜„ì¬ ì½”ë“œë¦¬ë·° ì§ê¿ í˜„í™©
            const codeReviewPairs = currentConfig.codeReviewPairs || [];
            if (codeReviewPairs.length > 0) {
                let pairsHtml = '';
                codeReviewPairs.forEach(pair => {
                    const memberNames = pair.members.map(member => `${member.name}(${member.id})`).join(' & ');
                    pairsHtml += `
                        <div class="review-pair-item">
                            <p><strong>ì§ê¿ ${pair.pairNumber}:</strong> ${memberNames}</p>
                            <p><strong>í¸ì„± ì£¼:</strong> ${pair.weekKey}</p>
                        </div>
                    `;
                });
                currentCodeReviewPairsDiv.innerHTML = pairsHtml;
            } else {
                currentCodeReviewPairsDiv.innerHTML = `
                    <div class="review-pair-item">
                        <p>ì´ë²ˆ ì£¼ ì½”ë“œë¦¬ë·° ì§ê¿ì´ ì•„ì§ í¸ì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
                        <p>ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤ì „ 9ì‹œì— ìë™ìœ¼ë¡œ í¸ì„±ë˜ê±°ë‚˜, ìˆ˜ë™ìœ¼ë¡œ í¸ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    </div>
                `;
            }
        }

        // ì´ë²ˆì£¼ ë‹¹ì§ í¸ì„±í‘œ ë¡œë“œ
        async function loadWeeklyDutySchedule() {
            try {
                const response = await fetch('/weekly-duty-schedule');
                if (response.ok) {
                    const weeklySchedule = await response.json();
                    displayWeeklyDutySchedule(weeklySchedule);
                } else {
                    weeklyDutyScheduleDiv.innerHTML = '<p>ì£¼ê°„ ë‹¹ì§ í¸ì„±í‘œë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
                }
            } catch (error) {
                console.error('Weekly duty schedule load error:', error);
                weeklyDutyScheduleDiv.innerHTML = '<p>ì£¼ê°„ ë‹¹ì§ í¸ì„±í‘œ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
            }
        }

        // ì£¼ê°„ ë‹¹ì§ í¸ì„±í‘œ í‘œì‹œ
        function displayWeeklyDutySchedule(weeklySchedule) {
            if (weeklySchedule.length === 0) {
                weeklyDutyScheduleDiv.innerHTML = '<p>ì´ë²ˆì£¼ ë‹¹ì§ í¸ì„±í‘œê°€ ì—†ìŠµë‹ˆë‹¤. ì£¼ê°„ ë‹¹ì§ í¸ì„±ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”.</p>';
                return;
            }

            let scheduleHtml = '<div class="weekly-schedule-grid">';
            weeklySchedule.forEach(day => {
                const isToday = day.date === new Date().toISOString().split('T')[0];
                const todayClass = isToday ? 'today' : '';
                
                const membersText = day.members.length > 0 
                    ? day.members.map(m => `${m.name}(${m.id})`).join(' & ')
                    : 'ë¯¸ë°°ì •';
                
                scheduleHtml += `
                    <div class="duty-day ${todayClass}">
                        <div class="day-header">
                            <strong>${day.dayName}</strong> (${day.displayDate})
                            ${isToday ? '<span class="today-badge">ì˜¤ëŠ˜</span>' : ''}
                        </div>
                        <div class="duty-members">
                            ${membersText}
                        </div>
                    </div>
                `;
            });
            scheduleHtml += '</div>';
            
            weeklyDutyScheduleDiv.innerHTML = scheduleHtml;
        }

        // ì˜¤ëŠ˜ì˜ ë‹¹ì§ì ë¡œë“œ
        async function loadTodayDutyStatus() {
            try {
                const response = await fetch('/today-duty');
                if (response.ok) {
                    const todayDuty = await response.json();
                    displayTodayDutyStatus(todayDuty);
                } else {
                    todayDutyStatusDiv.innerHTML = '<p>ì˜¤ëŠ˜ì˜ ë‹¹ì§ì ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
                }
            } catch (error) {
                console.error('Today duty load error:', error);
                todayDutyStatusDiv.innerHTML = '<p>ì˜¤ëŠ˜ì˜ ë‹¹ì§ì ì •ë³´ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
            }
        }

        // ì˜¤ëŠ˜ì˜ ë‹¹ì§ì í‘œì‹œ
        function displayTodayDutyStatus(todayDuty) {
            // ë‹¹ì§ìê°€ ì—†ê±°ë‚˜ hasNoDutyê°€ trueì¸ ê²½ìš°
            if (!todayDuty || todayDuty.hasNoDuty || !todayDuty.members || todayDuty.members.length === 0) {
                const currentDate = todayDuty?.displayDate || new Date().toLocaleDateString('ko-KR');
                todayDutyStatusDiv.innerHTML = `
                    <div class="today-duty-card no-duty">
                        <div class="duty-info">
                            <h3>ğŸ“… ì˜¤ëŠ˜(${currentDate})</h3>
                            <p><strong>ë‹¹ì§ìê°€ ë°°ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</strong></p>
                            <p>ì£¼ê°„ ë‹¹ì§ í¸ì„±ì„ ì‹¤í–‰í•˜ì—¬ ë‹¹ì§ìë¥¼ ë°°ì •í•´ì£¼ì„¸ìš”.</p>
                        </div>
                    </div>
                `;
                return;
            }

            const membersText = todayDuty.members.map(m => `${m.name}(${m.id})`).join(' & ');
            todayDutyStatusDiv.innerHTML = `
                <div class="today-duty-card">
                    <div class="duty-info">
                        <h3>ğŸš¨ ì˜¤ëŠ˜ì˜ ë‹¹ì§ì</h3>
                        <p class="duty-members-large">${membersText}</p>
                        <p class="duty-date">ë‚ ì§œ: ${todayDuty.displayDate}</p>
                    </div>
                    <div class="duty-tasks">
                        <h4>ë‹¹ì§ ì—…ë¬´</h4>
                        <ul>
                            <li>ë§¤ì¼ ì˜¤í›„ 2ì‹œ, 4ì‹œ ë‹¹ì§ ì²´í¬</li>
                            <li>ì‚¬ë¬´ì‹¤ ë³´ì•ˆ ìƒíƒœ í™•ì¸</li>
                            <li>ì‹œì„¤ ì´ìƒ ìœ ë¬´ ì ê²€</li>
                            <li>ê¸´ê¸‰ìƒí™© ë°œìƒì‹œ ì¦‰ì‹œ ë³´ê³ </li>
                        </ul>
                    </div>
                </div>
            `;
        }

        function showDutyDetails() {
            alert('ë‹¹ì§ ì—…ë¬´:\n- ì‚¬ë¬´ì‹¤ ê°œë°©/íì‡„\n- ë³´ì•ˆ ì ê²€\n- ê¸´ê¸‰ ìƒí™© ëŒ€ì‘\n\në‹¹ì§ìì—ê²ŒëŠ” ë§¤ì¼ ì˜¤í›„ 2ì‹œ, 4ì‹œì— ì•Œë¦¼ì´ ë°œì†¡ë©ë‹ˆë‹¤.');
        }

        // ìˆ˜ë™ ì‹¤í–‰ ë²„íŠ¼ ì´ë²¤íŠ¸
        executeWeeklyDutyBtn.addEventListener('click', async () => {
            if (confirm('ì£¼ê°„ ë‹¹ì§ì„ ìƒˆë¡œ í¸ì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ê¸°ì¡´ ë‹¹ì§ì´ ë³€ê²½ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.')) {
                try {
                    showStatus(statusMessageDiv, 'ì£¼ê°„ ë‹¹ì§ í¸ì„± ì¤‘...', 'info');
                    const response = await fetch('/execute-weekly-duty', { method: 'POST' });
                    if (response.ok) {
                        const data = await response.json();
                        showStatus(statusMessageDiv, data.message, 'success');
                        await loadInitialConfig();
                        await updateStatusTab();
                    } else {
                        const errorData = await response.json();
                        showStatus(statusMessageDiv, 'ì£¼ê°„ ë‹¹ì§ í¸ì„± ì‹¤íŒ¨: ' + errorData.message, 'error');
                    }
                } catch (error) {
                    showStatus(statusMessageDiv, 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ë¡œ ì£¼ê°„ ë‹¹ì§ì„ í¸ì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                }
            }
        });

        executeCodeReviewBtn.addEventListener('click', async () => {
            if (confirm('ì½”ë“œë¦¬ë·° ì§ê¿ì„ ìƒˆë¡œ í¸ì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                try {
                    showStatus(statusMessageDiv, 'ì½”ë“œë¦¬ë·° ì§ê¿ í¸ì„± ì¤‘...', 'info');
                    const response = await fetch('/execute-code-review', { method: 'POST' });
                    if (response.ok) {
                        const data = await response.json();
                        showStatus(statusMessageDiv, data.message, 'success');
                        await loadInitialConfig();
                        await updateStatusTab();
                    } else {
                        const errorData = await response.json();
                        showStatus(statusMessageDiv, 'ì½”ë“œë¦¬ë·° ì§ê¿ í¸ì„± ì‹¤íŒ¨: ' + errorData.message, 'error');
                    }
                } catch (error) {
                    showStatus(statusMessageDiv, 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ë¡œ ì½”ë“œë¦¬ë·° ì§ê¿ì„ í¸ì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                }
            }
        });

        refreshStatusBtn.addEventListener('click', async () => {
            await loadInitialConfig();
            await updateStatusTab();
            showStatus(statusMessageDiv, 'í˜„í™©ì´ ìƒˆë¡œê³ ì¹¨ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        });

        // íŒ€ì› ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function renderTeamMemberList() {
            teamMemberListDiv.innerHTML = '';
            if (currentConfig.teamMembers.length === 0) {
                teamMemberListDiv.innerHTML = '<p>ë“±ë¡ëœ íŒ€ì›ì´ ì—†ìŠµë‹ˆë‹¤. ì¶”ê°€í•´ì£¼ì„¸ìš”.</p>';
                return;
            }

            currentConfig.teamMembers.forEach(member => {
                const memberDiv = document.createElement('div');
                memberDiv.className = 'team-member-item';
                memberDiv.innerHTML = `
                    <p><strong>ID:</strong> ${member.id}</p>
                    <p><strong>ì´ë¦„:</strong> ${member.name}</p>
                    <p><strong>ê¶Œí•œ:</strong> ${member.isAuthorized ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}</p>
                    <p><strong>ë…¸íŠ¸ë¶ ì§€ì°¸ íšŸìˆ˜:</strong> ${member.laptopDutyCount || 0}íšŒ</p>
                    <p><strong>ì£¼ê°„ ë‹¹ì§ íšŸìˆ˜:</strong> ${member.weeklyDutyCount || 0}íšŒ</p>
                    <p><strong>ì½”ë“œë¦¬ë·° íšŸìˆ˜:</strong> ${member.codeReviewCount || 0}íšŒ</p>
                    <div class="actions">
                        <button class="edit-btn" data-id="${member.id}">í¸ì§‘</button>
                        <button class="delete-btn" data-id="${member.id}">ì‚­ì œ</button>
                    </div>
                `;
                teamMemberListDiv.appendChild(memberDiv);
            });

            document.querySelectorAll('.team-member-item .edit-btn').forEach(button => {
                button.addEventListener('click', (event) => {
                    const idToEdit = event.target.dataset.id;
                    const memberToEdit = currentConfig.teamMembers.find(m => m.id === idToEdit);
                    if (memberToEdit) {
                        teamMemberIdInput.value = memberToEdit.id;
                        teamMemberNameInput.value = memberToEdit.name;
                        isAuthorizedCheckbox.checked = memberToEdit.isAuthorized;
                        editingTeamMemberId = memberToEdit.id;
                        addTeamMemberButton.textContent = 'íŒ€ì› ì—…ë°ì´íŠ¸';
                        teamMemberIdInput.disabled = true;
                        
                        // íŒ€ì› ê´€ë¦¬ íƒ­ìœ¼ë¡œ ì´ë™
                        document.querySelector('[data-tab="team"]').click();
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                });
            });

            document.querySelectorAll('.team-member-item .delete-btn').forEach(button => {
                button.addEventListener('click', async (event) => {
                    const idToDelete = event.target.dataset.id;
                    if (confirm(`ì •ë§ë¡œ íŒ€ì› ID: ${idToDelete}ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                        currentConfig.teamMembers = currentConfig.teamMembers.filter(m => m.id !== idToDelete);
                        await sendTeamMembersToServer(currentConfig.teamMembers);
                    }
                });
            });
        }

        addTeamMemberButton.addEventListener('click', async () => {
            const id = teamMemberIdInput.value.trim();
            const name = teamMemberNameInput.value.trim();
            const isAuthorized = isAuthorizedCheckbox.checked;

            if (!id || !name) {
                showStatus(teamMemberStatusMessageDiv, 'íŒ€ì› IDì™€ ì´ë¦„ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }

            let updatedTeamMembers;
            if (editingTeamMemberId) {
                updatedTeamMembers = currentConfig.teamMembers.map(member =>
                    member.id === editingTeamMemberId ? { ...member, name, isAuthorized } : member
                );
                editingTeamMemberId = null;
                teamMemberIdInput.disabled = false;
                addTeamMemberButton.textContent = 'íŒ€ì› ì¶”ê°€';
            } else {
                if (currentConfig.teamMembers.some(member => member.id === id)) {
                    showStatus(teamMemberStatusMessageDiv, 'ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íŒ€ì› IDì…ë‹ˆë‹¤.', 'error');
                    return;
                }
                const newMember = {
                    id,
                    name,
                    isAuthorized,
                    laptopDutyCount: 0,
                    weeklyDutyCount: 0,
                    codeReviewCount: 0
                };
                updatedTeamMembers = [...currentConfig.teamMembers, newMember];
            }

            await sendTeamMembersToServer(updatedTeamMembers);
            teamMemberIdInput.value = '';
            teamMemberNameInput.value = '';
            isAuthorizedCheckbox.checked = false;
        });

        async function sendTeamMembersToServer(teamMembersToSend) {
            try {
                const response = await fetch('/update-team-members', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json; charset=UTF-8' },
                    body: JSON.stringify(teamMembersToSend)
                });
                if (response.ok) {
                    const data = await response.json();
                    showStatus(teamMemberStatusMessageDiv, data.message, 'success');
                    currentConfig.teamMembers = data.teamMembers;
                    renderTeamMemberList();
                    updateStatusTab();
                } else {
                    const errorData = await response.json();
                    showStatus(teamMemberStatusMessageDiv, 'íŒ€ì› ì •ë³´ ì €ì¥ ì‹¤íŒ¨: ' + (errorData.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'), 'error');
                }
            } catch (error) {
                showStatus(teamMemberStatusMessageDiv, 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ë¡œ íŒ€ì› ì •ë³´ë¥¼ ì €ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                console.error('Team member save error:', error);
            }
        }

        // ìŠ¤ì¼€ì¤„ ê´€ë¦¬ í•¨ìˆ˜ë“¤
        scheduleTypeSelect.addEventListener('change', () => {
            const selectedType = scheduleTypeSelect.value;
            if (selectedType === 'message') {
                messageGroup.style.display = 'block';
                recipientsGroup.style.display = 'block';
            } else {
                messageGroup.style.display = 'none';
                recipientsGroup.style.display = 'none';
            }
        });

        function renderScheduledList() {
            scheduledListDiv.innerHTML = '';
            if (currentConfig.schedules.length === 0) {
                scheduledListDiv.innerHTML = '<p>ë“±ë¡ëœ ì‚¬ìš©ì ì •ì˜ ìŠ¤ì¼€ì¤„ì´ ì—†ìŠµë‹ˆë‹¤. ìƒˆë¡œ ì¶”ê°€í•´ì£¼ì„¸ìš”.</p><p><small>* ê¸°ë³¸ ìŠ¤ì¼€ì¤„(ì£¼ê°„ë‹¹ì§, ë‹¹ì§ì•Œë¦¼, ì½”ë“œë¦¬ë·°)ì€ ìë™ìœ¼ë¡œ í™œì„±í™”ë©ë‹ˆë‹¤.</small></p>';
                return;
            }

            currentConfig.schedules.forEach((item, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = `schedule-item type-${item.type}`;
                
                let messageDisplay = item.message;
                let recipientsDisplay = item.recipients;

                switch(item.type) {
                    case 'message':
                        messageDisplay = item.message;
                        recipientsDisplay = item.recipients;
                        break;
                    case 'laptop_duty':
                        messageDisplay = 'ë…¸íŠ¸ë¶ ì§€ì°¸ ì•Œë¦¼ (ìë™ ìƒì„±)';
                        recipientsDisplay = 'ì „ì²´ íŒ€ì›';
                        break;
                    case 'code_review':
                        messageDisplay = 'ì½”ë“œ ë¦¬ë·° ì§ê¿ ì•Œë¦¼ (ìë™ ìƒì„±)';
                        recipientsDisplay = 'ì „ì²´ íŒ€ì›';
                        break;
                }

                itemDiv.innerHTML = `
                    <p><strong>íƒ€ì…:</strong> ${item.type === 'message' ? 'ì¼ë°˜ ë©”ì‹œì§€' : item.type === 'laptop_duty' ? 'ë…¸íŠ¸ë¶ ì§€ì°¸ ì•Œë¦¼' : 'ì½”ë“œ ë¦¬ë·° ì§ê¿ ì•Œë¦¼'}</p>
                    <p><strong>ë©”ì‹œì§€:</strong> ${messageDisplay}</p>
                    <p><strong>ìŠ¤ì¼€ì¤„:</strong> <code>${item.cronSchedule}</code></p>
                    <p><strong>ìˆ˜ì‹ ì:</strong> ${recipientsDisplay}</p>
                    <div class="actions">
                        <button class="execute-btn" data-id="${item.id}">ì¦‰ì‹œ ì‹¤í–‰</button>
                        <button class="edit-btn" data-id="${item.id}">í¸ì§‘</button>
                        <button class="delete-btn" data-id="${item.id}">ì‚­ì œ</button>
                    </div>
                `;
                scheduledListDiv.appendChild(itemDiv);
            });

            document.querySelectorAll('.schedule-item .execute-btn').forEach(button => {
                button.addEventListener('click', async (event) => {
                    const scheduleId = event.target.dataset.id;
                    const schedule = currentConfig.schedules.find(item => item.id === scheduleId);
                    if (schedule && confirm(`"${schedule.type}" ìŠ¤ì¼€ì¤„ì„ ì§€ê¸ˆ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                        await executeSchedule(scheduleId);
                    }
                });
            });

            document.querySelectorAll('.schedule-item .edit-btn').forEach(button => {
                button.addEventListener('click', (event) => {
                    const idToEdit = event.target.dataset.id;
                    const itemToEdit = currentConfig.schedules.find(item => item.id === idToEdit);
                    if (itemToEdit) {
                        scheduleTypeSelect.value = itemToEdit.type;
                        scheduleTypeSelect.dispatchEvent(new Event('change')); 

                        messageInput.value = itemToEdit.message;
                        cronScheduleInput.value = itemToEdit.cronSchedule;
                        recipientsInput.value = itemToEdit.recipients;
                        saveScheduleButton.dataset.editId = itemToEdit.id;
                        saveScheduleButton.textContent = 'ìŠ¤ì¼€ì¤„ ì—…ë°ì´íŠ¸';
                        
                        // ìŠ¤ì¼€ì¤„ ê´€ë¦¬ íƒ­ìœ¼ë¡œ ì´ë™
                        document.querySelector('[data-tab="schedule"]').click();
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                });
            });

            document.querySelectorAll('.schedule-item .delete-btn').forEach(button => {
                button.addEventListener('click', async (event) => {
                    const idToDelete = event.target.dataset.id;
                    if (confirm('ì •ë§ë¡œ ì´ ìŠ¤ì¼€ì¤„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        currentConfig.schedules = currentConfig.schedules.filter(item => item.id !== idToDelete);
                        await sendSchedulesToServer(currentConfig.schedules);
                    }
                });
            });
        }

        saveScheduleButton.addEventListener('click', async () => {
            const type = scheduleTypeSelect.value;
            const newMessage = messageInput.value.trim();
            const newCronSchedule = cronScheduleInput.value.trim();
            const newRecipients = recipientsInput.value.trim();
            const editId = saveScheduleButton.dataset.editId;

            let itemToSave = {
                id: editId || Date.now().toString(),
                type: type,
                cronSchedule: newCronSchedule
            };

            if (type === 'message') {
                if (!newMessage || !newRecipients || !newCronSchedule) {
                    showStatus(scheduleStatusMessageDiv, 'ë©”ì‹œì§€, ìŠ¤ì¼€ì¤„, ìˆ˜ì‹ ì í•„ë“œë¥¼ ëª¨ë‘ ì±„ì›Œì£¼ì„¸ìš”.', 'error');
                    return;
                }
                itemToSave.message = newMessage;
                itemToSave.recipients = newRecipients;
            } else {
                if (!newCronSchedule) {
                    showStatus(scheduleStatusMessageDiv, 'ìŠ¤ì¼€ì¤„ í•„ë“œë¥¼ ì±„ì›Œì£¼ì„¸ìš”.', 'error');
                    return;
                }
                itemToSave.message = ''; 
                itemToSave.recipients = ''; 
            }

            if (editId) {
                currentConfig.schedules = currentConfig.schedules.map(item =>
                    item.id === editId ? itemToSave : item
                );
            } else {
                currentConfig.schedules.push(itemToSave);
            }
            
            await sendSchedulesToServer(currentConfig.schedules);
            messageInput.value = '';
            cronScheduleInput.value = '';
            recipientsInput.value = '';
            scheduleTypeSelect.value = 'message';
            scheduleTypeSelect.dispatchEvent(new Event('change'));
            delete saveScheduleButton.dataset.editId;
            saveScheduleButton.textContent = 'ìŠ¤ì¼€ì¤„ ì €ì¥';
        });

        async function sendSchedulesToServer(schedulesToSend) {
            try {
                const response = await fetch('/update-schedules', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json; charset=UTF-8' },
                    body: JSON.stringify(schedulesToSend)
                });
                if (response.ok) {
                    const data = await response.json();
                    showStatus(scheduleStatusMessageDiv, data.message, 'success');
                    currentConfig.schedules = data.config;
                    renderScheduledList();
                    updateStatusTab();
                } else {
                    const errorData = await response.json();
                    showStatus(scheduleStatusMessageDiv, 'ìŠ¤ì¼€ì¤„ ì €ì¥ ì‹¤íŒ¨: ' + (errorData.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'), 'error');
                }
            } catch (error) {
                showStatus(scheduleStatusMessageDiv, 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ë¡œ ìŠ¤ì¼€ì¤„ì„ ì €ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                console.error('Schedule save error:', error);
            }
        }

        async function executeSchedule(scheduleId) {
            try {
                showStatus(scheduleStatusMessageDiv, 'ìŠ¤ì¼€ì¤„ ì‹¤í–‰ ì¤‘...', 'info');
                
                const response = await fetch('/execute-schedule', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json; charset=UTF-8' },
                    body: JSON.stringify({ scheduleId: scheduleId })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    showStatus(scheduleStatusMessageDiv, data.message, 'success');
                } else {
                    const errorData = await response.json();
                    showStatus(scheduleStatusMessageDiv, 'ìŠ¤ì¼€ì¤„ ì‹¤í–‰ ì‹¤íŒ¨: ' + (errorData.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'), 'error');
                }
            } catch (error) {
                showStatus(scheduleStatusMessageDiv, 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ë¡œ ìŠ¤ì¼€ì¤„ì„ ì‹¤í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                console.error('Schedule execution error:', error);
            }
        }

        async function loadInitialConfig() {
            try {
                const response = await fetch('/config');
                if (response.ok) {
                    const data = await response.json();
                    currentConfig = data;
                    renderTeamMemberList();
                    renderScheduledList();
                    await updateStatusTab();
                    scheduleTypeSelect.dispatchEvent(new Event('change'));
                } else {
                    showStatus(statusMessageDiv, 'ì„¤ì •ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.', 'error');
                    showStatus(teamMemberStatusMessageDiv, 'ì„¤ì •ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.', 'error');
                    showStatus(scheduleStatusMessageDiv, 'ì„¤ì •ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            } catch (error) {
                showStatus(statusMessageDiv, 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ë¡œ ì„¤ì •ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                showStatus(teamMemberStatusMessageDiv, 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ë¡œ ì„¤ì •ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                showStatus(scheduleStatusMessageDiv, 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ë¡œ ì„¤ì •ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                console.error('Initial config load error:', error);
            }
        }

        // GitHub ê¸°ëŠ¥ í•¨ìˆ˜ë“¤
        async function loadGitHubStatus() {
            try {
                const response = await fetch('/github/status');
                if (response.ok) {
                    const status = await response.json();
                    updateGitHubStatusDisplay(status);
                    
                    if (status.isEnabled) {
                        await loadGitHubConfig();
                    }
                } else {
                    githubServiceStatusSpan.textContent = 'ì˜¤ë¥˜';
                    githubRepoCountSpan.textContent = '0ê°œ';
                    githubMemberCountSpan.textContent = '0ëª…';
                    githubWeeklyStatusSpan.textContent = 'ë¹„í™œì„±';
                }
            } catch (error) {
                console.error('GitHub status load error:', error);
                githubServiceStatusSpan.textContent = 'ì˜¤ë¥˜';
            }
        }

        function updateGitHubStatusDisplay(status) {
            githubServiceStatusSpan.textContent = status.isEnabled ? 'í™œì„±' : 'ë¹„í™œì„±';
            githubRepoCountSpan.textContent = `${status.config?.repositoryCount || 0}ê°œ`;
            githubMemberCountSpan.textContent = `${status.config?.teamMemberCount || 0}ëª…`;
            githubWeeklyStatusSpan.textContent = status.config?.weeklyReportsEnabled ? 'í™œì„±' : 'ë¹„í™œì„±';
            
            // ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™”
            const isEnabled = status.isEnabled;
            githubPreviewWeeklyBtn.disabled = !isEnabled;
            githubPreviewMonthlyBtn.disabled = !isEnabled;
            githubCheckAlertsBtn.disabled = !isEnabled;
            githubGenerateCustomReportBtn.disabled = !isEnabled;
            githubGetMemberStatsBtn.disabled = !isEnabled;
        }

        async function loadGitHubConfig() {
            try {
                const response = await fetch('/github/config');
                if (response.ok) {
                    const config = await response.json();
                    
                    // ì„¤ì • í¼ì— ë°ì´í„° ì±„ìš°ê¸°
                    githubTokenInput.value = config.githubToken === '[CONFIGURED]' ? '' : config.githubToken;
                    
                    if (config.repositories) {
                        const repoList = config.repositories.map(repo => `${repo.owner}/${repo.name}`).join('\n');
                        githubRepoListTextarea.value = repoList;
                    }
                    
                    if (config.teamMembers) {
                        const memberList = config.teamMembers.map(member => `${member.githubUsername}:${member.displayName}`).join('\n');
                        githubTeamMembersTextarea.value = memberList;
                        
                        // ë©¤ë²„ ì„ íƒ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
                        githubMemberSelect.innerHTML = '<option value="">ë©¤ë²„ ì„ íƒ...</option>';
                        config.teamMembers.forEach(member => {
                            const option = document.createElement('option');
                            option.value = member.githubUsername;
                            option.textContent = `${member.displayName} (${member.githubUsername})`;
                            githubMemberSelect.appendChild(option);
                        });
                    }
                    
                    githubWeeklyEnabledCheckbox.checked = config.reporting?.weeklyReports?.enabled || false;
                    githubMonthlyEnabledCheckbox.checked = config.reporting?.monthlyReports?.enabled || false;
                    
                } else {
                    showStatus(githubConfigMessageDiv, 'GitHub ì„¤ì •ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                }
            } catch (error) {
                console.error('GitHub config load error:', error);
                showStatus(githubConfigMessageDiv, 'GitHub ì„¤ì • ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // ì§„í–‰ë„ ì„¸ë¶€ì‚¬í•­ ì—…ë°ì´íŠ¸
        function updateProgressDetails(progressData) {
            if (!progressData) {
                githubProgressDetailsDiv.classList.remove('visible');
                return;
            }
            
            currentProgressData = progressData;
            
            let stepsHtml = '';
            
            // ê¸°ë³¸ ì§„í–‰ ìƒíƒœ
            stepsHtml += `
                <div class="progress-step">
                    <span class="step-name">ì§„í–‰ ìƒíƒœ:</span> ${progressData.message}
                </div>
            `;
            
            // ì „ì²´ ì§„í–‰ë¥ 
            if (progressData.percentage !== null) {
                stepsHtml += `
                    <div class="progress-step">
                        <span class="step-name">ì „ì²´ ì§„í–‰ë¥ :</span> ${progressData.percentage}%
                    </div>
                `;
            }
            
            // ë‹¨ê³„ ì •ë³´
            if (progressData.currentStep && progressData.totalSteps) {
                stepsHtml += `
                    <div class="progress-step">
                        <span class="step-name">ë‹¨ê³„:</span> ${progressData.currentStep} / ${progressData.totalSteps}
                    </div>
                `;
            }
            
            // ë¦¬í¬ì§€í† ë¦¬ ì •ë³´
            if (progressData.repository) {
                stepsHtml += `
                    <div class="progress-step">
                        <span class="step-name">í˜„ì¬ ë¦¬í¬ì§€í† ë¦¬:</span> ${progressData.repository}
                    </div>
                `;
            }
            
            // ë¦¬í¬íŠ¸ ID
            if (progressData.reportId) {
                stepsHtml += `
                    <div class="progress-step">
                        <span class="step-name">ë¦¬í¬íŠ¸ ID:</span> 
                        <span class="step-detail">${progressData.reportId}</span>
                    </div>
                `;
            }
            
            // ì‹œê°„ ì •ë³´
            if (progressData.timestamp) {
                const time = new Date(progressData.timestamp).toLocaleTimeString();
                stepsHtml += `
                    <div class="progress-step">
                        <span class="step-name">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸:</span> ${time}
                    </div>
                `;
            }
            
            progressStepsDiv.innerHTML = stepsHtml;
            githubProgressDetailsDiv.classList.add('visible');
        }

        // ì €ì¥ì†Œ í†µê³„ ë¡œë“œ
        async function loadStorageStats() {
            try {
                const response = await fetch('/github/storage-stats');
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        const stats = result.data;
                        previewCountSpan.textContent = `${stats.preview.count}ê°œ`;
                        archiveCountSpan.textContent = `${stats.archive.count}ê°œ`;
                        totalSizeSpan.textContent = `${stats.total.sizeMB} MB`;
                    }
                }
            } catch (error) {
                console.error('Storage stats load error:', error);
            }
        }

        // ë¦¬í¬íŠ¸ ì´ë ¥ ë¡œë“œ
        async function loadReportHistory() {
            try {
                const response = await fetch('/github/report-history?limit=20');
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        displayReportHistory(result.data);
                    } else {
                        githubReportHistoryDiv.innerHTML = '<p style="text-align: center; padding: 20px; color: #dc3545;">ë¦¬í¬íŠ¸ ì´ë ¥ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
                    }
                } else {
                    githubReportHistoryDiv.innerHTML = '<p style="text-align: center; padding: 20px; color: #dc3545;">ë¦¬í¬íŠ¸ ì´ë ¥ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
                }
            } catch (error) {
                console.error('Report history load error:', error);
                githubReportHistoryDiv.innerHTML = '<p style="text-align: center; padding: 20px; color: #dc3545;">ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
            }
        }

        // ë¦¬í¬íŠ¸ ì´ë ¥ í‘œì‹œ
        function displayReportHistory(reports) {
            if (reports.length === 0) {
                githubReportHistoryDiv.innerHTML = '<p style="text-align: center; padding: 20px; color: #666;">ë¦¬í¬íŠ¸ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            let historyHtml = '';
            reports.forEach(report => {
                const date = new Date(report.generatedAt || report.sentAt).toLocaleString();
                const typeText = report.type === 'weekly' ? 'ì£¼ê°„' : report.type === 'monthly' ? 'ì›”ê°„' : 'ì¼ë°˜';
                const categoryText = report.category === 'preview' ? 'ë¯¸ë¦¬ë³´ê¸°' : 'ì•„ì¹´ì´ë¸Œ';
                const sizeText = report.size ? `${(report.size / 1024).toFixed(1)} KB` : 'N/A';
                
                historyHtml += `
                    <div class="report-item">
                        <div class="report-info">
                            <div class="report-title">${typeText} ë¦¬í¬íŠ¸ (${categoryText})</div>
                            <div class="report-meta">
                                ${date} | ${sizeText} | ID: ${report.id.substring(0, 12)}...
                            </div>
                        </div>
                        <div class="report-actions">
                            <button class="secondary-btn" onclick="deleteReport('${report.id}')">ì‚­ì œ</button>
                        </div>
                    </div>
                `;
            });
            
            githubReportHistoryDiv.innerHTML = historyHtml;
        }

        // ë¦¬í¬íŠ¸ ì‚­ì œ
        async function deleteReport(reportId) {
            if (!confirm('ì´ ë¦¬í¬íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }
            
            try {
                const response = await fetch('/github/delete-report', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ reportId })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        showStatus(githubConfigMessageDiv, result.message, 'success');
                        await loadReportHistory(); // ì´ë ¥ ìƒˆë¡œê³ ì¹¨
                        await loadStorageStats(); // í†µê³„ ìƒˆë¡œê³ ì¹¨
                    } else {
                        showStatus(githubConfigMessageDiv, result.message, 'error');
                    }
                } else {
                    showStatus(githubConfigMessageDiv, 'ë¦¬í¬íŠ¸ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            } catch (error) {
                showStatus(githubConfigMessageDiv, 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // GitHub ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë“¤
        githubRefreshStatusBtn.addEventListener('click', async () => {
            await loadGitHubStatus();
            showStatus(githubConfigMessageDiv, 'GitHub ìƒíƒœê°€ ìƒˆë¡œê³ ì¹¨ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        });

        // ë¦¬í¬íŠ¸ ìƒì„± ìƒíƒœ ê´€ë¦¬ í•¨ìˆ˜ (ê°œì„ ëœ ë²„ì „)
        function setReportGeneratingState(isGenerating, reportType = null) {
            isGeneratingReport = isGenerating;
            reportGenerationAborted = false;
            
            if (isGenerating) {
                // ë¯¸ë¦¬ë³´ê¸° ë²„íŠ¼ë“¤ ë¹„í™œì„±í™” ë° ë¡œë”© ìƒíƒœ í‘œì‹œ
                githubPreviewWeeklyBtn.disabled = true;
                githubPreviewMonthlyBtn.disabled = true;
                githubPreviewWeeklyBtn.classList.add('loading');
                githubPreviewMonthlyBtn.classList.add('loading');
                
                // ì·¨ì†Œ ë²„íŠ¼ í‘œì‹œ
                githubCancelReportBtn.style.display = 'inline-block';
                
                // ìƒíƒœ í‘œì‹œ ì—…ë°ì´íŠ¸
                githubReportStatusSpan.textContent = 'í†µê³„ ìˆ˜ì§‘ ì¤‘...';
                githubReportStatusSpan.className = 'report-status generating';
                
                // ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ì— ë¡œë”© í‘œì‹œ
                githubReportPreviewDiv.innerHTML = `
                    <div class="report-preview-loading">
                        <div>GitHub ë¦¬í¬ì§€í† ë¦¬ì—ì„œ í†µê³„ë¥¼ ìˆ˜ì§‘í•˜ê³  ìˆìŠµë‹ˆë‹¤...</div>
                        <div>ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</div>
                    </div>
                `;
                
                // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½
                if (reportType === 'weekly') {
                    githubPreviewWeeklyBtn.textContent = 'ì£¼ê°„ ë¦¬í¬íŠ¸ ìˆ˜ì§‘ ì¤‘...';
                } else if (reportType === 'monthly') {
                    githubPreviewMonthlyBtn.textContent = 'ì›”ê°„ ë¦¬í¬íŠ¸ ìˆ˜ì§‘ ì¤‘...';
                }
                
                // ì „ì†¡ ë²„íŠ¼ ì˜ì—­ ìˆ¨ê¸°ê¸°
                githubSendButtonsDiv.style.display = 'none';
                
            } else {
                // ë²„íŠ¼ë“¤ í™œì„±í™” ë° ë¡œë”© ìƒíƒœ ì œê±°
                githubPreviewWeeklyBtn.disabled = false;
                githubPreviewMonthlyBtn.disabled = false;
                githubPreviewWeeklyBtn.classList.remove('loading');
                githubPreviewMonthlyBtn.classList.remove('loading');
                
                // ì·¨ì†Œ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
                githubCancelReportBtn.style.display = 'none';
                
                // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³µì›
                githubPreviewWeeklyBtn.textContent = 'GitHub ì£¼ê°„ ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸°';
                githubPreviewMonthlyBtn.textContent = 'GitHub ì›”ê°„ ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸°';
            }
        }

        // ë¦¬í¬íŠ¸ ìƒì„± ì·¨ì†Œ í•¨ìˆ˜
        function cancelReportGeneration() {
            if (!isGeneratingReport) return;
            
            reportGenerationAborted = true;
            setReportGeneratingState(false);
            
            // ìƒíƒœ ì—…ë°ì´íŠ¸
            githubReportStatusSpan.textContent = 'ì·¨ì†Œë¨';
            githubReportStatusSpan.className = 'report-status cancelled';
            
            // ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ ì—…ë°ì´íŠ¸
            githubReportPreviewDiv.innerHTML = `
                <div class="report-preview-placeholder">
                    <div class="cancel-message">
                        ë¦¬í¬íŠ¸ ìƒì„±ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.<br>
                        ë‹¤ì‹œ ìƒì„±í•˜ë ¤ë©´ ë¯¸ë¦¬ë³´ê¸° ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.
                    </div>
                </div>
            `;
            
            // í˜„ì¬ ë¦¬í¬íŠ¸ ë°ì´í„° ì´ˆê¸°í™”
            currentReportData = null;
            currentReportType = null;
            
            showStatus(githubConfigMessageDiv, 'ë¦¬í¬íŠ¸ ìƒì„±ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
        }

        // ë¦¬í¬íŠ¸ ìƒì„± ì™„ë£Œ ì²˜ë¦¬ í•¨ìˆ˜
        function handleReportGenerationComplete(data, reportType) {
            if (reportGenerationAborted) {
                return; // ì·¨ì†Œëœ ê²½ìš° ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ
            }
            
            setReportGeneratingState(false);
            
            if (data.success) {
                // ì„±ê³µ ì²˜ë¦¬
                githubReportPreviewDiv.textContent = data.preview;
                githubSendButtonsDiv.style.display = 'block';
                currentReportData = data.preview;
                currentReportType = reportType;
                
                githubReportStatusSpan.textContent = 'ìƒì„± ì™„ë£Œ';
                githubReportStatusSpan.className = 'report-status completed';
                
                const reportTypeText = reportType === 'weekly' ? 'ì£¼ê°„' : 'ì›”ê°„';
                showStatus(githubConfigMessageDiv, `${reportTypeText} ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸°ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ë°œì†¡í•˜ì‹œë ¤ë©´ ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.`, 'success');
            } else {
                // ì‹¤íŒ¨ ì²˜ë¦¬
                githubReportPreviewDiv.innerHTML = `
                    <div class="report-preview-placeholder">
                        <div style="color: #dc3545;">âŒ ë¦¬í¬íŠ¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</div>
                        <div style="color: #6c757d; font-size: 0.9em; margin-top: 10px;">${data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'}</div>
                    </div>
                `;
                
                githubReportStatusSpan.textContent = 'ìƒì„± ì‹¤íŒ¨';
                githubReportStatusSpan.className = 'report-status error';
                
                showStatus(githubConfigMessageDiv, data.message || 'ë¦¬í¬íŠ¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸° ì´ˆê¸°í™” í•¨ìˆ˜
        function resetReportPreview() {
            currentReportData = null;
            currentReportType = null;
            githubSendButtonsDiv.style.display = 'none';
            githubReportStatusSpan.textContent = 'ëŒ€ê¸° ì¤‘';
            githubReportStatusSpan.className = 'report-status';
            githubReportPreviewDiv.innerHTML = `
                <div class="report-preview-placeholder">
                    ğŸ“Š ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸°ë¥¼ ë³´ë ¤ë©´ ìœ„ì˜ 'ë¯¸ë¦¬ë³´ê¸°' ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.
                </div>
            `;
        }

        githubPreviewWeeklyBtn.addEventListener('click', async () => {
            if (isGeneratingReport) return;
            
            try {
                setReportGeneratingState(true, 'weekly');
                showStatus(githubConfigMessageDiv, 'GitHub ì£¼ê°„ ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸° ìƒì„± ì¤‘...', 'info');
                
                const response = await fetch('/github/preview-weekly-report', { method: 'POST' });
                
                // ì·¨ì†Œ í™•ì¸
                if (reportGenerationAborted) return;
                
                if (response.ok) {
                    const data = await response.json();
                    handleReportGenerationComplete(data, 'weekly');
                } else {
                    const errorData = await response.json();
                    const errorResponse = {
                        success: false,
                        message: errorData.message || 'GitHub ì£¼ê°„ ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸° ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'
                    };
                    handleReportGenerationComplete(errorResponse, 'weekly');
                }
            } catch (error) {
                if (!reportGenerationAborted) {
                    const errorResponse = {
                        success: false,
                        message: 'GitHub ì£¼ê°„ ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸° ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
                    };
                    handleReportGenerationComplete(errorResponse, 'weekly');
                }
            }
        });

        githubPreviewMonthlyBtn.addEventListener('click', async () => {
            if (isGeneratingReport) return;
            
            try {
                setReportGeneratingState(true, 'monthly');
                showStatus(githubConfigMessageDiv, 'GitHub ì›”ê°„ ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸° ìƒì„± ì¤‘...', 'info');
                
                const response = await fetch('/github/preview-monthly-report', { method: 'POST' });
                
                // ì·¨ì†Œ í™•ì¸
                if (reportGenerationAborted) return;
                
                if (response.ok) {
                    const data = await response.json();
                    handleReportGenerationComplete(data, 'monthly');
                } else {
                    const errorData = await response.json();
                    const errorResponse = {
                        success: false,
                        message: errorData.message || 'GitHub ì›”ê°„ ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸° ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'
                    };
                    handleReportGenerationComplete(errorResponse, 'monthly');
                }
            } catch (error) {
                if (!reportGenerationAborted) {
                    const errorResponse = {
                        success: false,
                        message: 'GitHub ì›”ê°„ ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸° ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
                    };
                    handleReportGenerationComplete(errorResponse, 'monthly');
                }
            }
        });

        githubSendReportBtn.addEventListener('click', async () => {
            if (!currentReportData) {
                showStatus(githubConfigMessageDiv, 'ì „ì†¡í•  ë¦¬í¬íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }

            if (confirm(`GitHub ${currentReportType === 'weekly' ? 'ì£¼ê°„' : 'ì›”ê°„'} ë¦¬í¬íŠ¸ë¥¼ ì±„ë„ë¡œ ì „ì†¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                try {
                    showStatus(githubConfigMessageDiv, 'GitHub ë¦¬í¬íŠ¸ ì „ì†¡ ì¤‘...', 'info');
                    const response = await fetch('/github/send-report', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ message: currentReportData })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        showStatus(githubConfigMessageDiv, data.message, 'success');
                        // ì „ì†¡ í›„ ì´ˆê¸°í™”
                        resetReportPreview();
                        githubReportPreviewDiv.innerHTML = '<div class="report-preview-placeholder">ğŸ“¤ ë¦¬í¬íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.</div>';
                    } else {
                        const errorData = await response.json();
                        showStatus(githubConfigMessageDiv, errorData.message, 'error');
                    }
                } catch (error) {
                    showStatus(githubConfigMessageDiv, 'GitHub ë¦¬í¬íŠ¸ ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }
        });

        githubCheckAlertsBtn.addEventListener('click', async () => {
            try {
                showStatus(githubConfigMessageDiv, 'GitHub í™œë™ ì•Œë¦¼ ì²´í¬ ì¤‘...', 'info');
                const response = await fetch('/github/check-alerts', { method: 'POST' });
                if (response.ok) {
                    const data = await response.json();
                    showStatus(githubConfigMessageDiv, data.message, data.success ? 'success' : 'info');
                } else {
                    const errorData = await response.json();
                    showStatus(githubConfigMessageDiv, errorData.message, 'error');
                }
            } catch (error) {
                showStatus(githubConfigMessageDiv, 'GitHub í™œë™ ì•Œë¦¼ ì²´í¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        });

        githubGenerateCustomReportBtn.addEventListener('click', async () => {
            const startDate = githubStartDateInput.value;
            const endDate = githubEndDateInput.value;
            const sendToChannel = githubSendToChannelCheckbox.checked;
            
            if (!startDate || !endDate) {
                showStatus(githubCustomReportMessageDiv, 'ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            try {
                showStatus(githubCustomReportMessageDiv, 'ì»¤ìŠ¤í…€ ë¦¬í¬íŠ¸ ìƒì„± ì¤‘...', 'info');
                const response = await fetch('/github/custom-report', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ startDate, endDate, sendToChannel })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    showStatus(githubCustomReportMessageDiv, data.message, 'success');
                    
                    // ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
                    if (data.report) {
                        githubReportPreviewDiv.textContent = data.report;
                    }
                } else {
                    const errorData = await response.json();
                    showStatus(githubCustomReportMessageDiv, errorData.message, 'error');
                }
            } catch (error) {
                showStatus(githubCustomReportMessageDiv, 'ì»¤ìŠ¤í…€ ë¦¬í¬íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        });

        githubGetMemberStatsBtn.addEventListener('click', async () => {
            const githubUsername = githubMemberSelect.value;
            const startDate = githubMemberStartDateInput.value;
            const endDate = githubMemberEndDateInput.value;
            
            if (!githubUsername) {
                showStatus(githubMemberStatsResultDiv, 'ë©¤ë²„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            if (!startDate || !endDate) {
                showStatus(githubMemberStatsResultDiv, 'ë¶„ì„ ê¸°ê°„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            try {
                showStatus(githubMemberStatsResultDiv, 'ë©¤ë²„ í†µê³„ ì¡°íšŒ ì¤‘...', 'info');
                const response = await fetch('/github/member-stats', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ githubUsername, startDate, endDate })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        const stats = data.data;
                        const statsText = `
ğŸ“Š ${stats.displayName} (${stats.username}) í†µê³„\n
- ì»¤ë°‹: ${stats.commits}íšŒ\n- PR ìƒì„±: ${stats.prsCreated}ê°œ\n- PR ë¦¬ë·°: ${stats.prsReviewed}ê°œ\n- ì´ìŠˆ ìƒì„±: ${stats.issuesCreated}ê°œ\n- ì´ìŠˆ í•´ê²°: ${stats.issuesClosed}ê°œ\n- ì½”ë“œ ë³€ê²½: +${stats.linesAdded} / -${stats.linesDeleted}\n- ë¦¬ë·° ì½”ë©˜íŠ¸: ${stats.reviewComments}ê°œ
                        `.trim();
                        
                        githubMemberStatsResultDiv.innerHTML = `<pre style="background-color: #f8f9fa; padding: 10px; border-radius: 5px; font-size: 0.9em; line-height: 1.4; white-space: pre-wrap;">${statsText}</pre>`;
                        githubMemberStatsResultDiv.style.display = 'block';
                    } else {
                        showStatus(githubMemberStatsResultDiv, data.message, 'error');
                    }
                } else {
                    const errorData = await response.json();
                    showStatus(githubMemberStatsResultDiv, errorData.message, 'error');
                }
            } catch (error) {
                showStatus(githubMemberStatsResultDiv, 'ë©¤ë²„ í†µê³„ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        });

        githubUpdateConfigBtn.addEventListener('click', async () => {
            const token = githubTokenInput.value.trim();
            const repoListText = githubRepoListTextarea.value.trim();
            const teamMembersText = githubTeamMembersTextarea.value.trim();
            
            // ì—…ë°ì´íŠ¸í•  ì„¤ì •ë§Œ ìˆ˜ì§‘
            const newConfig = {};
            
            // í† í°ì´ ì…ë ¥ëœ ê²½ìš°ë§Œ ì¶”ê°€
            if (token) {
                newConfig.githubToken = token;
            }
            
            // ë¦¬í¬ì§€í† ë¦¬ê°€ ì…ë ¥ëœ ê²½ìš°ë§Œ ì¶”ê°€
            if (repoListText) {
                try {
                    const repositories = repoListText.split('\n').filter(line => line.trim()).map(line => {
                        const [owner, name] = line.trim().split('/');
                        if (!owner || !name) {
                            throw new Error(`ì˜ëª»ëœ ë¦¬í¬ì§€í† ë¦¬ í˜•ì‹: ${line}`);
                        }
                        return { owner, name };
                    });
                    newConfig.repositories = repositories;
                } catch (error) {
                    showStatus(githubConfigMessageDiv, `ë¦¬í¬ì§€í† ë¦¬ í˜•ì‹ ì˜¤ë¥˜: ${error.message}`, 'error');
                    return;
                }
            }
            
            // íŒ€ì› ì •ë³´ê°€ ì…ë ¥ëœ ê²½ìš°ë§Œ ì¶”ê°€
            if (teamMembersText) {
                try {
                    const teamMembers = teamMembersText.split('\n').filter(line => line.trim()).map(line => {
                        const [githubUsername, displayName] = line.trim().split(':');
                        if (!githubUsername || !displayName) {
                            throw new Error(`ì˜ëª»ëœ íŒ€ì› í˜•ì‹: ${line}`);
                        }
                        return { githubUsername, displayName };
                    });
                    newConfig.teamMembers = teamMembers;
                } catch (error) {
                    showStatus(githubConfigMessageDiv, `íŒ€ì› ì •ë³´ í˜•ì‹ ì˜¤ë¥˜: ${error.message}`, 'error');
                    return;
                }
            }
            
            // ë¦¬í¬íŠ¸ ì„¤ì •ì€ í•­ìƒ ì—…ë°ì´íŠ¸
            newConfig.reporting = {
                weeklyReports: { enabled: githubWeeklyEnabledCheckbox.checked },
                monthlyReports: { enabled: githubMonthlyEnabledCheckbox.checked }
            };
            
            // ë¹„ì–´ìˆëŠ” ì„¤ì • ì²´í¬
            if (Object.keys(newConfig).length === 1 && newConfig.reporting) {
                showStatus(githubConfigMessageDiv, 'ì—…ë°ì´íŠ¸í•  ì„¤ì •ì´ ì—†ìŠµë‹ˆë‹¤. ìµœì†Œí•œ í•œ ê°€ì§€ ì„¤ì •ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            try {
                showStatus(githubConfigMessageDiv, 'GitHub ì„¤ì • ì—…ë°ì´íŠ¸ ì¤‘...', 'info');
                const response = await fetch('/github/update-config', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(newConfig)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    showStatus(githubConfigMessageDiv, data.message, 'success');
                    
                    // ìƒíƒœ ìƒˆë¡œê³ ì¹¨
                    await loadGitHubStatus();
                } else {
                    const errorData = await response.json();
                    showStatus(githubConfigMessageDiv, errorData.message, 'error');
                }
            } catch (error) {
                showStatus(githubConfigMessageDiv, 'GitHub ì„¤ì • ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        });

        // ë¦¬í¬íŠ¸ ê´€ë¦¬ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        githubRefreshStorageBtn.addEventListener('click', async () => {
            await loadStorageStats();
            showStatus(githubConfigMessageDiv, 'ì €ì¥ì†Œ í†µê³„ê°€ ìƒˆë¡œê³ ì¹¨ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        });

        githubClearCacheBtnBtn.addEventListener('click', async () => {
            if (confirm('ëª¨ë“  ìºì‹œëœ ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì•„ì¹´ì´ë¸ŒëŠ” ë³´ì¡´ë©ë‹ˆë‹¤.')) {
                try {
                    const response = await fetch('/github/clear-cache', { method: 'POST' });
                    if (response.ok) {
                        const result = await response.json();
                        showStatus(githubConfigMessageDiv, result.message, result.success ? 'success' : 'error');
                        await loadStorageStats(); // í†µê³„ ìƒˆë¡œê³ ì¹¨
                        if (githubReportHistorySection.style.display !== 'none') {
                            await loadReportHistory(); // ì´ë ¥ ìƒˆë¡œê³ ì¹¨
                        }
                    } else {
                        showStatus(githubConfigMessageDiv, 'ìºì‹œ ì •ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                    }
                } catch (error) {
                    showStatus(githubConfigMessageDiv, 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }
        });

        githubToggleHistoryBtn.addEventListener('click', async () => {
            if (githubReportHistorySection.style.display === 'none') {
                githubReportHistorySection.style.display = 'block';
                githubToggleHistoryBtn.textContent = 'ë¦¬í¬íŠ¸ ì´ë ¥ ìˆ¨ê¸°ê¸°';
                await loadReportHistory();
            } else {
                githubReportHistorySection.style.display = 'none';
                githubToggleHistoryBtn.textContent = 'ë¦¬í¬íŠ¸ ì´ë ¥ ë³´ê¸°';
            }
        });

        // ë¦¬í¬íŠ¸ ì‚­ì œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        githubDiscardReportBtn.addEventListener('click', () => {
            if (confirm('ìƒì„±ëœ ë¦¬í¬íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                resetReportPreview();
                showStatus(githubConfigMessageDiv, 'ë¦¬í¬íŠ¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
            }
        });

        window.addEventListener('load', () => {
            loadInitialConfig();
            // ì´ˆê¸° ë¡œë“œì‹œ GitHub ìƒíƒœë„ ë¡œë“œ
            loadGitHubStatus();
            // ë¦¬í¬íŠ¸ ë¯¸ë¦¬ë³´ê¸° ì´ˆê¸°í™”
            resetReportPreview();
            // ì €ì¥ì†Œ í†µê³„ ë¡œë“œ
            loadStorageStats();
        });
    </script>
</body>
</html>